<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/js/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="/My97DatePicker/WdatePicker.js"></script>
</head>
<body>
<form>
航班姓名<input type="text" id="name1" name="name"><br>
起飞时间<input type="text" name="startTime" id="startTime1" onclick="WdatePicker()"><br>
机票类型<input type="radio" value="1">经济舱<input type="radio" value="2">头等舱<br>
是否有票<input type="radio" value="1">有<input type="radio" value="2">无<br>
机型大小<input type="radio" value="1">大型<input type="radio" value="2">中型<input type="radio" value="3">小型<br>
机型<select></select><br>
出发城市<input><br>
到达城市<input><br>
<input type="button" value="查询"><input type="reset" value="重置">
</form>
  <table id="table" cellpadding="0" cellspacing="0" border="1">
      <tr>
          <td><input type="checkbox"></td>
          <td>航班姓名</td>
          <td>起飞时间</td>
          <td>到达时间</td>
          <td>票数</td>
          <td>票价</td>
          <td>操作</td>
      </tr>

  </table>
<br>
  <form id="addForm">
添加航班<br>
航班姓名<input type="text" id="name" name="name"><br>
起飞时间<input type="text" name="startTime" id="startTime" onclick="WdatePicker()"><br>
到达时间<input type="text" name="endTime" id="endTime" onclick="WdatePicker()"><br>
机型<select id="type" name="typeId">
      <option></option>
  </select><br>
出发机场:<select id="city" onchange="initAirport()">
      <option></option>
  </select>
<select id="airport" onchange="initTerminal()">
    <option></option>
</select>
<select id="terminal" name="startTermianlId">
    <option></option>
</select>
<br>
  到达机场:<select id="tCity" onchange="initAirport2()">
      <option></option>
  </select>
  <select id="tAirport" onchange="initTerminal2()">
      <option></option>
  </select>
  <select id="tTerminal" name="endTermianlId">
      <option></option>
  </select>
  <br>
机票<select id="jingji" name="jingji">
      <option value="1">经济舱</option>
  </select>
<input name="totalCountt" id="totalCountt"><input name="pricee" id="pricee"><br>
  <select id="toudeng" name="toudeng">
      <option value="2">头等舱</option>
  </select>
  <input name ="totalCount" id="totalCount"><input name="price" id="price"><br>
      <input type="button" value="提交" onclick="addForm()">
  </form>
</body>
<script type="text/javascript">
    $(function () {
        initTable();
        initForm()
        initCity()
        inittCity();
    })
    function addForm() {

        $.ajax({
            url:"http://localhost:9077/flight/addForm",
            type:"post",
            data:$("#addForm").serialize(),
            dataType:"json",
            success:function (result) {
            if(result.code == 200){
                alert(result.message)
                location.reload
            }
            }
        })
    }
    function initForm() {
        $.ajax({
            url:"http://localhost:9077/flight/initForm",
            type:"post",
            dataType:"json",
            success:function (result) {
                var typeHtml= ""
                for (var i=0;i<result.length;i++){
                    typeHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
             }
             $("#type").html(typeHtml)
            }
        })
    }
    function initCity() {
        $.ajax({
            url:"http://localhost:9077/flight/initCity",
            type:"post",
            dataType:"json",
            success:function (result) {
                var cityHtml=""
              for (var i=0;i<result.length;i++){
                  cityHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
              }
              $("#city").html(cityHtml)
                initAirport()
            }
        })
    }
    function initAirport(id) {
        if(id == null){
            id= $("#city").val()
        }
        $.ajax({
            url:"http://localhost:9077/flight/initAirport",
            type:"post",
            dataType:"json",
            data:{"id":id},
            success:function (result) {
                 var airportHtml=""
                 for (var i=0;i<result.length;i++){
                     airportHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
                 }
                 $("#airport").html(airportHtml)
                 initTerminal()
            }
        })
    }
    function initTerminal(id) {
        if (id == null ){
            id= $("#airport").val()
        }
        $.ajax({
            url:"http://localhost:9077/flight/initTerminal",
            type:"post",
            dataType:"json",
            data:{"id":id},
            success:function (result) {
                var terminalHtml=""
                for (var i=0;i<result.length;i++){
                    terminalHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
                }
                $("#terminal").html(terminalHtml)
            }
        })
    }

    function inittCity() {
        $.ajax({
            url:"http://localhost:9077/flight/initCity",
            type:"post",
            dataType:"json",
            success:function (result) {
                var cityHtml=""
                for (var i=0;i<result.length;i++){
                    cityHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
                }
                $("#tCity").html(cityHtml)
                initAirport2()
            }
        })
    }
    function initAirport2(id) {
        if(id == null){
            id= $("#tCity").val()
        }
        $.ajax({
            url:"http://localhost:9077/flight/initAirport",
            type:"post",
            dataType:"json",
            data:{"id":id},
            success:function (result) {
                var airportHtml=""
                for (var i=0;i<result.length;i++){
                    airportHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
                }
                $("#tAirport").html(airportHtml)
                initTerminal2()
            }
        })
    }
    function initTerminal2(id) {
        if (id == null ){
            id= $("#tAirport").val()
        }
        $.ajax({
            url:"http://localhost:9077/flight/initTerminal",
            type:"post",
            dataType:"json",
            data:{"id":id},
            success:function (result) {
                var terminalHtml=""
                for (var i=0;i<result.length;i++){
                    terminalHtml+='<option value='+result[i].id+'>'+result[i].name+'</option>'
                }
                $("#tTerminal").html(terminalHtml)

            }
        })
    }
    function initTable() {
        $.ajax({
            url:"http://localhost:9077/flight/initTable",
            type:"post",
            dataType:"json",
            success:function (result) {
                  var html=""
                  for (var i=0;i<result.length;i++){
                      if(result[i].planeTypeId == 1){
                         var type = "大型"
                      }
                      if(result[i].planeTypeId == 2){
                          var type = "中型"
                      }else {
                          var type = "小型"
                      }
                      html+='<tr><td><input type="checkbox"></td><td>'+result[i].flightName+"<br>"+result[i].planeName+"("+type+")"+'</td>'
                      if (result[i].near != null){
                          html+='<td>'+result[i].startTime+"<br>"+result[i].near+"<br>"+result[i].startPAreaName+result[i].startAreaName+'</td>'
                      }else {
                          html+='<td>'+result[i].startTime+"<br>"+result[i].startPAreaName+result[i].startAreaName+'</td>'
                      }
                          html+='<td>'+result[i].endTime+"<br>"+result[i].endPAreaName+result[i].endAreaName+'</td>'
                          html+='<td>'+result[i].totalCount+'</td><td>'+result[i].price+'</td>'
                          html+='<td><input type="button" value="订票"><input type="button" value="修改"><input type="button" value="取消航班"></td>'
                  }
                  $("#table").append(html)
            }
        })
    }
</script>
</html>